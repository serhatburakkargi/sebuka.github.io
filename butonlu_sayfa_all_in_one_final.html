<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Butonlu Sayfa ‚Äî Hepsi Tek Dosya</title>
<style>
:root{
  --bg:#0b0f17; --card:#0b1220; --accent:#00b894; --muted:#9fb0c8;
  --btn:#142235; --input:#0f1724; --border:#1b2636;
}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,system-ui,Roboto,-apple-system,Segoe UI,Arial;color:#e6eef8;
background:linear-gradient(180deg,#051026 0%,var(--bg) 100%);display:flex;align-items:center;
justify-content:center;min-height:100vh;padding:20px;}
.container{width:100%;max-width:720px;padding:18px;border-radius:16px;background:var(--card);
box-shadow:0 12px 40px rgba(2,6,23,0.6)}
.header{display:flex;gap:12px;align-items:center;margin-bottom:14px}
.logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.03),transparent);
display:flex;align-items:center;justify-content:center;border:1px solid rgba(255,255,255,0.03)}
.logo strong{color:var(--accent)}
h1{font-size:18px;margin:0}
.lead{font-size:13px;color:var(--muted);margin-top:4px}
.buttons{display:flex;flex-direction:column;gap:12px;margin-top:12px}
.btn{display:flex;align-items:center;gap:12px;padding:14px;border-radius:12px;
background:var(--btn);border:1px solid rgba(255,255,255,0.02);cursor:pointer;overflow:hidden}
.btn:hover{transform:translateY(-3px);transition:transform .15s}
.icon{width:48px;height:48px;border-radius:10px;display:flex;align-items:center;justify-content:center;
background:rgba(255,255,255,0.02);flex-shrink:0;font-size:20px}
.label{font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:60%}
.sublabel{font-size:12px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:35%}
.editor{margin-top:16px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.02));
padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.02)}
.row{display:flex;gap:8px;align-items:center;margin-bottom:8px;flex-wrap:wrap}
input[type=text],select{flex:1;min-width:100px;padding:8px;border-radius:8px;border:1px solid var(--border);
background:var(--input);color:#fff;font-size:13px}
button.small{padding:8px 10px;border-radius:8px;border:1px solid var(--border);background:var(--input);color:#fff;cursor:pointer}
.controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px;justify-content:space-between;align-items:center}
.footer{margin-top:12px;font-size:12px;color:var(--muted);text-align:center}

/* Editor actions */
.row .actions{display:flex;gap:6px;align-items:center;margin-left:auto;flex-shrink:0}
.row .actions button{padding:6px 8px}

/* extra small screens */
@media(max-width:480px){
  .label{max-width:50%}
  .sublabel{max-width:40%}
  input[type=text],select{min-width:70px}
}
</style>
</head>
<body>
<div class="container" role="application" aria-label="Butonlu Sayfa">
  <div class="header">
    <div class="logo"><strong>SB</strong></div>
    <div>
      <h1>Butonlu Sayfa</h1>
      <div class="lead">Her buton: Link / Mail / Dosya. ƒ∞kon ve mail adresi d√ºzenlenebilir.</div>
    </div>
  </div>

  <div class="buttons" id="buttons" aria-live="polite"></div>

  <div class="editor" id="editor">
    <div style="font-weight:700;margin-bottom:8px">Butonlarƒ± D√ºzenle</div>
    <div id="edit-list"></div>
    <div class="controls">
      <div style="display:flex;gap:8px;align-items:center">
        <button id="addBtn" class="small">Buton Ekle</button>
        <button id="exportBtn" class="small">Dƒ±≈üa Aktar</button>
        <button id="importBtn" class="small">ƒ∞√ße Aktar</button>
        <button id="resetBtn" class="small">Sƒ±fƒ±rla</button>
      </div>
      <div style="font-size:12px;color:var(--muted)">Deƒüi≈üiklikler tarayƒ±cƒ±da saklanƒ±r.</div>
    </div>
  </div>

  <div class="footer">Mobil √∂ncelikli ‚Äî masa√ºst√º ve tablet uyumlu</div>
</div>

<script>
const STORAGE_KEY = "butonlu_all_in_one_v1";
// fileData stores uploaded files per button id: { id: { name: string, dataUrl: string } }
let fileData = {};

const DEFAULTS = [
  { id: 1, label: "Instagram", url: "https://www.instagram.com/sebukagraphic_", icon: "üì∑", type: "link" },
  { id: 2, label: "E-posta", mail: "serhatbrkkrg@gmail.com", icon: "‚úâÔ∏è", type: "mail" }
];

function load(){ try{ const s = localStorage.getItem(STORAGE_KEY); const f = localStorage.getItem(STORAGE_KEY + "_files"); if(f) fileData = JSON.parse(f); return s ? JSON.parse(s) : DEFAULTS.slice(); }catch(e){ console.warn(e); return DEFAULTS.slice(); } }
function save(d){ localStorage.setItem(STORAGE_KEY, JSON.stringify(d)); localStorage.setItem(STORAGE_KEY + "_files", JSON.stringify(fileData)); }

function escapeHtml(s){ if(!s) return ""; return String(s).replace(/[&<>"']/g, m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }
function escapeAttr(s){ if(!s) return ""; return String(s).replace(/"/g,'&quot;'); }

function renderButtons(list){
  const c = document.getElementById("buttons"); c.innerHTML = "";
  list.forEach(it=>{
    const b = document.createElement("div"); b.className = "btn"; b.tabIndex = 0;
    const icon = escapeHtml(it.icon || "üîó");
    const label = escapeHtml(it.label || "");
    let sub = "";
    if(it.type === "mail") sub = escapeHtml(it.mail || "E-posta");
    else if(it.type === "dosya") sub = (fileData[it.id] ? fileData[it.id].name : "Dosya");
    else sub = escapeHtml(it.url || "");
    b.innerHTML = '<div class="icon" aria-hidden="true">'+ icon +'</div>' +
                  '<div style="min-width:0"><div class="label">'+ label +'</div>' +
                  '<div class="sublabel">'+ sub +'</div></div>';
    b.addEventListener("click", ()=> openItem(it));
    b.addEventListener("keydown", (e)=>{ if(e.key === "Enter") openItem(it); });
    c.appendChild(b);
  });
}

function openItem(it){
  if(it.type === "mail"){
    const mail = it.mail || "";
    if(!mail){ alert("Bu buton i√ßin e-posta adresi ayarlƒ± deƒüil."); return; }
    window.location.href = "mailto:" + mail;
    return;
  }
  if(it.type === "dosya"){
    const f = fileData[it.id];
    if(!f){ alert("Bu butona dosya eklenmemi≈ü."); return; }
    const a = document.createElement("a"); a.href = f.dataUrl; a.download = f.name; a.click(); return;
  }
  if(it.url){
    window.open(it.url, "_blank", "noopener");
    return;
  }
  alert("Bu buton i√ßin i≈ülem tanƒ±mlƒ± deƒüil.");
}

function renderEditor(list){
  const el = document.getElementById("edit-list"); el.innerHTML = "";
  list.forEach((it, idx)=>{
    const row = document.createElement("div"); row.className = "row";
    row.innerHTML = `
      <input data-i="${idx}" class="lbl" placeholder="Etiket" value="${escapeAttr(it.label||'')}" />
      <input data-i="${idx}" class="url" placeholder="https://..." value="${escapeAttr(it.url||'')}" />
      <select data-i="${idx}" class="typ">
        <option value="link">Link</option>
        <option value="mail">Mail</option>
        <option value="dosya">Dosya</option>
      </select>
      <input data-i="${idx}" class="icn" placeholder="ikon" value="${escapeAttr(it.icon||'üîó')}" style="width:60px" />
      <div class="extra"></div>
      <div class="actions">
        <button data-i="${idx}" class="small up" title="Yukarƒ±">‚ñ≤</button>
        <button data-i="${idx}" class="small down" title="A≈üaƒüƒ±">‚ñº</button>
        <button data-i="${idx}" class="small del" title="Sil">üóë</button>
      </div>`;
    el.appendChild(row);
  });
  // set selects and extras, then attach handlers
  el.querySelectorAll(".typ").forEach(sel=> sel.value = (list[sel.dataset.i] && list[sel.dataset.i].type) ? list[sel.dataset.i].type : "link");
  updateExtras(list);
  attachHandlers(list);
}

function updateExtras(list){
  document.querySelectorAll(".extra").forEach(ex=>{
    ex.innerHTML = "";
    const idx = +ex.parentElement.querySelector(".lbl").dataset.i;
    const it = list[idx];
    if(it.type === "mail"){
      const inp = document.createElement("input"); inp.type = "text"; inp.placeholder = "E-posta adresi"; inp.value = it.mail || "";
      inp.oninput = e=>{ it.mail = e.target.value; save(list); renderButtons(list); };
      ex.appendChild(inp);
    } else if(it.type === "dosya"){
      const btn = document.createElement("button"); btn.className = "small"; btn.textContent = (fileData[it.id] ? "Dosya Deƒüi≈ütir" : "Dosya Y√ºkle");
      btn.onclick = ()=>{
        const finput = document.createElement("input"); finput.type = "file"; finput.accept = ".pdf,image/*,application/*";
        finput.onchange = e=>{
          const file = e.target.files[0]; if(!file) return;
          const reader = new FileReader();
          reader.onload = ev=>{
            fileData[it.id] = { name: file.name, dataUrl: ev.target.result };
            save(list); renderButtons(list); updateExtras(list);
            alert("Dosya y√ºklendi: " + file.name);
          };
          reader.readAsDataURL(file);
        };
        finput.click();
      };
      ex.appendChild(btn);
      if(fileData[it.id]){
        const small = document.createElement("div"); small.style.marginLeft="8px"; small.style.fontSize="12px"; small.style.color="var(--muted)";
        small.textContent = fileData[it.id].name;
        ex.appendChild(small);
        const dl = document.createElement("button"); dl.className="small"; dl.style.marginLeft="8px"; dl.textContent="ƒ∞ndir"; dl.onclick=()=>{ const a=document.createElement('a'); a.href=fileData[it.id].dataUrl; a.download=fileData[it.id].name; a.click(); };
        ex.appendChild(dl);
        const rm = document.createElement("button"); rm.className="small"; rm.style.marginLeft="6px"; rm.textContent="Kaldƒ±r"; rm.onclick=()=>{ delete fileData[it.id]; save(list); renderButtons(list); updateExtras(list); };
        ex.appendChild(rm);
      }
    }
  });
}

function attachHandlers(list){
  document.querySelectorAll(".lbl").forEach(x=> x.oninput = e=>{ const i=+x.dataset.i; list[i].label = e.target.value; save(list); renderButtons(list); });
  document.querySelectorAll(".url").forEach(x=> x.oninput = e=>{ const i=+x.dataset.i; list[i].url = e.target.value; save(list); renderButtons(list); });
  document.querySelectorAll(".icn").forEach(x=> x.oninput = e=>{ const i=+x.dataset.i; list[i].icon = e.target.value; save(list); renderButtons(list); });
  document.querySelectorAll(".typ").forEach(x=> x.onchange = e=>{ const i=+x.dataset.i; list[i].type = e.target.value; save(list); renderEditor(list); renderButtons(list); });
  document.querySelectorAll(".up").forEach(b=> b.onclick = ()=>{ const i=+b.dataset.i; if(i<=0) return; [list[i-1], list[i]] = [list[i], list[i-1]]; save(list); renderEditor(list); renderButtons(list); });
  document.querySelectorAll(".down").forEach(b=> b.onclick = ()=>{ const i=+b.dataset.i; if(i>=list.length-1) return; [list[i], list[i+1]] = [list[i+1], list[i]]; save(list); renderEditor(list); renderButtons(list); });
  document.querySelectorAll(".del").forEach(b=> b.onclick = ()=>{ const i=+b.dataset.i; if(!confirm("Bu butonu silmek istiyor musunuz?")) return; // remove associated file
    const id = list[i].id; if(fileData[id]) delete fileData[id]; list.splice(i,1); save(list); renderEditor(list); renderButtons(list); });
}

function downloadJSON(d){ const blob = new Blob([JSON.stringify(d,null,2) ], { type: "application/json" }); const url = URL.createObjectURL(blob); const a = document.createElement("a"); a.href = url; a.download = "butonlar.json"; a.click(); setTimeout(()=>URL.revokeObjectURL(url),200); }

function init(){
  let data = load();
  // ensure each entry has an id
  data = data.map(it=> it.id ? it : Object.assign({ id: Date.now()+Math.floor(Math.random()*10000) }, it) );
  save(data);
  renderButtons(data); renderEditor(data);

  document.getElementById("addBtn").onclick = ()=>{ data.push({ id: Date.now(), label: "Yeni Buton", url: "", icon: "üîó", type: "link" }); save(data); renderEditor(data); renderButtons(data); };
  document.getElementById("exportBtn").onclick = ()=> downloadJSON(data);
  document.getElementById("importBtn").onclick = ()=>{ const inp = document.createElement("input"); inp.type = "file"; inp.accept = "application/json"; inp.onchange = e=>{ const f = e.target.files[0]; if(!f) return; const r = new FileReader(); r.onload = ev=>{ try{ data = JSON.parse(ev.target.result); save(data); renderEditor(data); renderButtons(data); alert("ƒ∞√ße aktarma ba≈üarƒ±lƒ±"); }catch(err){ alert("Ge√ßersiz JSON"); } }; r.readAsText(f); }; inp.click(); };
  document.getElementById("resetBtn").onclick = ()=>{ if(confirm("T√ºm ayarlar sƒ±fƒ±rlansƒ±n mƒ±?")){ localStorage.removeItem(STORAGE_KEY); localStorage.removeItem(STORAGE_KEY + "_files"); fileData = {}; data = []; renderEditor(data); renderButtons(data); } };
}

document.addEventListener("DOMContentLoaded", init);
</script>
</body>
</html>
